\documentclass{beamer}
%
% Choose how your presentation looks.
%
% For more themes, color themes and font themes, see:
% http://deic.uab.es/~iblanes/beamer_gallery/index_by_theme.html
%
\mode<presentation>
{
  \usetheme{default}      % or try Darmstadt, Madrid, Warsaw, ...
  \usecolortheme{default} % or try albatross, beaver, crane, ...
  \usefonttheme{default}  % or try serif, structurebold, ...
  \setbeamertemplate{navigation symbols}{}
  \setbeamertemplate{caption}[numbered]
} 

\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

\usepackage{amsmath, amssymb, physics, tikz, tikz-feynman, quantikz}
\usepackage{graphicx, subcaption}

%\input{./macros}
%\setcounter{TikzExternaliseName}{0}\def\tikzsubfolder{S2}

\title{Tensor Networks : Session 2}
\author{Hanse Kim}

\begin{document}

\begin{frame}
  \titlepage
\end{frame}

\begin{frame}{Recap}
\begin{itemize}
	\item Tensor networks are tensors (state vectors) that are made up of smaller tensors by tensor products and contraction
		\begin{itemize}
	\item Many ways to write a tensor of a given rank ${ N }$
	\item Represents subspaces of Hilbert space
	\item Degree of freedom polynomial in ${ N }$
	\end{itemize}
\end{itemize}
\end{frame}
\begin{frame}{Examples : General TNs}
	\begin{itemize}
	\item Trace 
		\begin{figure}[h]
		\includegraphics[width=0.4\textwidth]{trace}
		\centering
		\end{figure}
		
	\item Reduced density matrix (partial trace of bipartite state vector)
	\item SVD decomposition
		\begin{figure}[h]
		\includegraphics[width=0.6\textwidth]{svd}
		\centering
		\end{figure}
		\begin{itemize}
			\item Bond dimension determined by number of nonzero singular values of SVD
		\end{itemize}
		
	\end{itemize}
\end{frame}
\begin{frame}{Recap}
	\begin{itemize}
\item Some comments
	\begin{itemize}
	\item Some notation differentiates upper and lower indices by placement of 'legs'
	\item Rank ${ (p,q) }$ tensor has ${ (p+q+1)! }$ reshapes generated by swapping and lowering/uppering indices 
	\item Do not confuse rank of tensor ex. ${ (p,q) }$ and rank of linear operator (dimensionality of image)
	\end{itemize}
\item Notation conventions
	\begin{itemize}
	\item Tensors : either vector notation ${ \ket{\psi } }$ or tensors ${ A }$
	\item Operators (MPOs) : boldface ${ \boldsymbol{\sigma }, \boldsymbol{H} }$
	\end{itemize}
\end{itemize}
\end{frame}

\begin{frame}{Recap}
	\begin{itemize}
\item \textbf{Claimed} that the TN state subspace is physically relevant; we will see today :
	\begin{itemize}
		\item Examples of highly entangled states/ground states as TNs
	\item Bond dimension parametrises entanglement entropy; contraction characterises entanglement
	\item TN states satisfy the area entropy law 
	\end{itemize}
\end{itemize}
\end{frame}


\begin{frame}{Matrix Product States}
	\begin{itemize}
		\item \textbf{MPS} : 1D array of tensors
		\begin{itemize}
		\item Two examples; open BC, periodic BC
		\item One tensor per site in many-body system; open indices represents physical degrees of freedom
		\item DoF : ${ pD^2N }$
		\end{itemize}
	\end{itemize}
	\begin{figure}[h]
	\includegraphics[width=0.8\textwidth]{mps}
	\centering
	\end{figure}
	
\end{frame}

\begin{frame}{Examples : MPS}
\begin{itemize}
	\item \textbf{GHZ State} : ${ \ket{\Psi }=\frac{1}{\sqrt{2}}(\ket{0}^{\otimes N}+\ket{1}^{\otimes N}) }$
		\begin{itemize}
		\item Maximally entangled state : reduced density matrix is diagonal for any bipartition of system
		\item MPS representation with bond dimension 2
		\end{itemize}
	\end{itemize}
	\begin{figure}[h]
	\includegraphics[width=0.6\textwidth]{ghz}
	\centering
	\end{figure}
	
\end{frame}

\begin{frame}{Examples : MPS}
	\begin{itemize}
		\item 1D PEPS (Projected Entangled Pair State)
			\begin{figure}[h]
			\includegraphics[width=0.8\textwidth]{peps1d}
			\centering
			\end{figure}
			
	\item Ground state of \textbf{1D AKLT} model : spin 1 chain with ${ H=\sum_{\ev{i,j}}^{} \vec{S}_{i}\cdot \vec{S}_{j}+ \frac{1}{3}(\vec{S}_{i}\cdot \vec{S}_{j})^{2} }$
		\begin{itemize}
		\item Exact ground state is given in terms of projection of a spin ${ \frac{1}{2} }$ chain
			\begin{figure}[h]
			\includegraphics[width=0.5\textwidth]{aklt}
			\centering
			\end{figure}
			
		\item MPS representation with bond dimension 2
		\end{itemize}
	\end{itemize}
\end{frame}

\begin{frame}{Examples : MPS}
	\begin{itemize}
	\item \textbf{1D Cluster State} : simultaneous eigenket of ${ K^{i}=\sigma ^{x}_{i-1}\sigma ^{z}_{i}\sigma ^{x}_{i+1} }$; ${ \ket{\Psi }=\prod_i \frac{ 1+K^{i}}{2} \ket{0}^{\otimes N}}$
		\begin{itemize}
		\item Highly entangled state
		\item Represent operators ${ \frac{1+K^{i}}{2} }$ as TN
		\item MPS representation with bond dimension 4
		\end{itemize}
\end{itemize}	
\begin{figure}[h]
\includegraphics[width=0.5\textwidth]{1dcluster}
\centering
\end{figure}

\end{frame}

\begin{frame}{Examples : PEPS}
	\begin{itemize}
	\item \textbf{Toric code} eigenstates : given space of spins on edges on lattice, states where flipped spins form closed loops 
		\begin{itemize}
		\item Corresponds to trivial space of stabilisers;\\
			${ A_{v}=\prod_{i \in v} \sigma _{i}, B_{p} =\prod_{i \in p}\sigma _{i}}$
		\end{itemize}
		\begin{figure}[h]
		\includegraphics[width=0.2\textwidth]{toric}
		\centering
		\end{figure}
		\begin{itemize}
		\item Used in quantum error correction
		\end{itemize}
	\end{itemize}
\end{frame}

\begin{frame}{Examples : PEPS}
	\begin{itemize}
	\item \textbf{Toric code} eigenstate : express lattice in form below
	\end{itemize}
	\makebox[\linewidth]{{
	\includegraphics[width=0.5\textwidth]{toricimage}
	\hspace{0.1cm}
{\includegraphics[width=0.5\textwidth]{toriclatt}} }}
	
\end{frame}

\begin{frame}{Examples : PEPS}
	\begin{itemize}
	\item \textbf{Toric code} ground state : superposition of all closed loops; admits PEPS form
	\end{itemize}
	\makebox[\linewidth]{{
	\includegraphics[width=0.5\textwidth]{toricstate}
	\hspace{0.1cm}
{\includegraphics[width=0.5\textwidth]{toricnet}} }}
\begin{itemize}
\begin{itemize}
	\item Assign odd numbered plaquettes to PEPS site
\item ${ i,j,k,l \in \mathbb{Z}_{2} }$; straight legs indicate bond indices; wavy legs qubits on each edge of plaquette
\end{itemize}
\end{itemize}	
\end{frame}

\begin{frame}{SVD and Schmidt Decomposition}
	\begin{itemize}
	\item Split wavefunction into parts; SVD gives Schmidt decomposition ${ \ket{\psi }=\sum_{i}^{} \lambda _{i}\ket{L_{i}}\otimes \ket{R_{i}} }$
	\end{itemize}
		\begin{figure}[h]
		\includegraphics[width=0.75\textwidth]{schmidt}
		\centering
		\end{figure}
		\begin{itemize}
		\item Recursive application decomposes state into MPS
		\end{itemize}
\end{frame}

\begin{frame}{SVD and Schmidt Decomposition}
			\begin{itemize}
		\item \textbf{Rank} : distinct from rank of tensor, dimensionality of image
					\begin{itemize}
			\item Ex. ${ m \times n }$ matrix of rank one : outer product of ${ m }$ vector and ${ n }$ vector
			\item ${ m \times  n }$ matrix of rank ${ k }$ : total ${ k(m+n) }$ DoF
				\end{itemize}
			\item Number of nonzero ${ \lambda _{i} }$ = rank of diagonal matrix ${ \lambda  }$ = bond dimension of MPS
		\end{itemize}

\end{frame}


\begin{frame}{Area Law : MPS}
	\begin{itemize}
	\item Area law : constant (wrt. ${ N }$) entanglement entropy
	\item Decomposition; ${ \ket{\psi }=\sum_{i}^{} \lambda _{i}\ket{L_{i}}\otimes \ket{R_{i}} }$
		\begin{itemize}
		\item ${ i }$ represents the bond indices; only require one as matrix ${ \lambda  }$ is diagonal
		\end{itemize}
	\item Reduced density matrix : ${ \rho =\sum_{i}^{} \lambda _{i}^{2}\ket{L_{i}}\bra{L_{i}} }$
\item Entanglement entropy : ${ S=-\text{tr}(\rho \log{\rho })=-\sum_{i}^{} \lambda _{i}^{2}\log{\lambda _{i}^{2}} }$
\item Bound : given normalisation ${ \sum_{i}^{} \lambda _{i}^{2}=1 }$, maximum entropy at all ${ \lambda _{i}^{2} =\frac{1}{D}}$, ${ S \leq \log{D} }$
		\end{itemize}
\end{frame}

\begin{frame}{Area Law : PEPS}
	\begin{figure}[h]
	\includegraphics[width=0.8\textwidth]{peps}
	\centering
	\end{figure}
\end{frame}

\begin{frame}{Area Law : PEPS}
	\begin{itemize}
	\item Area law : entropy ${ \sim  L}$
	\item Decomposition : ${ \ket{\psi }= \sum_{\overline{\alpha }}^{} \ket{\text{in}_{\overline{\alpha }}}\otimes \ket{\text{out}_{\overline{\alpha }}}}$
		\begin{itemize}
		\item ${ \overline{\alpha } }$ represents joint bond indices; total of ${ D^{\partial A} =D^{4L}}$ values
		\end{itemize}
	\item Reduced density matrix : ${ \rho =\sum_{\overline{\alpha },\overline{\alpha }^{\prime}}^{} \ev{\text{out}_{\overline{\alpha }^{\prime}}|\text{out}_{\overline{\alpha }}}\ket{\text{in}_{\overline{\alpha }}}\bra{\text{in}_{\overline{\alpha }^{\prime}}} }$
	\item Similarly, maximum entropy for ${ S=-\text{tr}\rho \log{\rho }\leq  4L \log{D}}$
	\end{itemize}
\end{frame}


\begin{frame}{Finitely Correlated : MPS}
\begin{itemize}
	\item Correlation function : ${ C(r)=\ev{O_{i}O^{\prime}_{i+r}} - \ev{O_{i}}\ev{O^{\prime}_{i+r}} }$\\
		Consider infinite MPS of single tensor; 1D translational invariance with thermodynamic limit
\end{itemize}	
	\begin{figure}[h]
	\includegraphics[width=0.8\textwidth]{corr}
	\centering
	\end{figure}
\end{frame}

\begin{frame}{Finitely Correlated : MPS}
		\begin{figure}[h]
		\includegraphics[width=0.6\textwidth]{fincor}
		\centering
		\end{figure}
	\begin{itemize}
		\item Consider ${ E_{i} }$ as ${ D^2 \times D^2  }$ matrix; diagonalise ${ E_{I} =\sum_{i=1}^{D^2 } \lambda _{i}\ket{L_{i}}\bra{R_{i}}}$; ${ E_{I}^{r}=\lambda _{1}^{r}\sum_{i=1}^{D^2 } (\lambda _{i}/\lambda _{1})^{r}\ket{L_{i}}\bra{R_{i}} }$
		\item Consider dominant EVs; ${ E_{I}^{r}\approx \lambda _{1}^{r}\left( \ket{L_{1}}\bra{R_{1}}+(\lambda _{2}/\lambda _{1})^{r} \sum_{}^{} \ket{L_{\mu }}\bra{R_{\mu }}\right)  }$
	\end{itemize}
\end{frame}

\begin{frame}{Finitely Correlated : MPS}
	\begin{figure}[h]
	\includegraphics[width=0.8\textwidth]{corr}
	\centering
	\end{figure}
\begin{itemize}
	\item ${O_{i}}=\text{tr}(E_{I}^{n-1}E_{O}E_{I}^{N-n}) /\text{tr}(E_{I}^{N})$\\
	\item	In therm. limit, ${ \ev{O_{i}}\approx \ev{R_{1}|E_{O}|L_{1}}/\lambda _{1}}$
\item ${ \ev{O_{i}}\ev{O^{\prime}_{i+r}}\approx \ev{R_{1}|E_{O}|L_{1}}\ev{R_{1}|E_{O^{\prime}}|L_{1}}/\lambda _{1}^{2} }$

\end{itemize}
\end{frame}

\begin{frame}{Finitely Correlated : MPS}
	\begin{figure}[h]
	\includegraphics[width=0.8\textwidth]{corr}
	\centering
	\end{figure}
\begin{itemize}
\item ${ \ev{O_{i}O^{\prime}_{i+r}}=\text{tr}(E_{I}^{n-1}E_{O}E_{I}^{r-1}E_{O^{\prime}}E_{I}^{N-n-r}) /\text{tr}(E_{I}^{N})}$\\
\item	In therm. limit, ${ \ev{O_{i}O^{\prime}_{i+r}}\approx \ev{R_{1}|E_{O}E_{I}^{r-1}E_{O^{\prime}}|L_{1}}/\ev{R_{1}|E_{I}^{r+1}|L_{1}}}$\\
	${ \approx \ev{R_{1}|E_{O}|L_{1}}\ev{L_{1}|E_{O}|R_{1}}/\lambda _{1}^{2} }+(\lambda _{2}/\lambda _{1})^{r}A$
	\item ${ C(r)\sim \exp -r/\xi }$ with ${ \xi =-1  /\log{|\lambda _{1}/\lambda _{2}|}}$

\end{itemize}
\end{frame}

\begin{frame}{Finitely Correlated : MPS}
	\begin{itemize}
	\item Exponential decay of two-point correlation function
	\item Results known where such exponential decay \textit{implies} the area law
	\item Correlation function mimics quantum system in lower spatial dimension
	\end{itemize}
\end{frame}

\begin{frame}{MPS Algorithms}
% choice of bond dimension?
	The term MPS algorithm can refer to any of the following;
		\vspace{.5cm}
		\begin{itemize}
		\item Approximation of general tensors into MPS
			\begin{itemize}
			\item Low rank approx.
			\item MPS compression
			\end{itemize}
		\item (Efficient) computations involving MPS
			\begin{itemize}
			\item Inner products, expectation values etc.
			\end{itemize}
	\item Calculating ground states
		\begin{itemize}
		\item Variational method over TN space; DMRG
		\item Imaginary time evolution
		\end{itemize}
	\end{itemize}
\end{frame}



\begin{frame}{MPS Algorithms}
	\begin{itemize}
	\item Can we decompose an arbitrary rank N tensor into an MPS state? Yes! By recursively applying SVD
		\begin{itemize}
		\item For ${ N }$ particle system, bond dimension is bounded above by ${ 2^{\lfloor N/2\rfloor}}$; MPS are dense
		\item Expensive in terms of calculations
		\end{itemize}
	\end{itemize}
\end{frame}

\begin{frame}{MPS Algorithms}
	\begin{itemize}
		\item \textbf{Low rank approximation}
			\begin{itemize}
				\item Eckart-Young theorem : optimal low rank approximation appears via SVD
				\item Truncate to ${ k }$ singular values
			\end{itemize}
		\item Use low rank approximation to apply cutoff to bond dimension of MPS; approximation of general state
		%\item Can also heuristically choose to cutoff of singular values at $\xi ={ \frac{1}{\sqrt{p^{N}}} }$; error is ${ \mathcal{O}(\xi^2) }$
	\end{itemize}
	
\end{frame}

%\begin{frame}{MPS Algorithms : DMRG}
%	\begin{itemize}
%	\item 
%	\end{itemize}
%\end{frame}

%\begin{frame}{MPS Algorithms : TEBD}
%	\begin{itemize}
%	\item 
%	\end{itemize}
%\end{frame}

\begin{frame}{TN Algorithms : MPS EV}
	\begin{figure}[h]
	\includegraphics[width=0.75\textwidth]{mpscontr}
	\centering
	\end{figure}
	
\end{frame}

\begin{frame}{TN Algorithms : PEPS EV}
	\begin{itemize}
	\item Contraction of a 2D lattice is computationally complex
	\item Approximation required; reduce the original problem to a series of 1D problems equivalent to the ground state calculations problems above!\\
\end{itemize}
\end{frame}

\begin{frame}{References and Resources}
	\begin{itemize}
	\item Hand-waving and Interpretive Dance : An Introductory Course on Tensor Networks; Jacob C. Bridgeman, Christopher T. Chubb
	\item A Practical Introduction to Tensor Networks : Matrix Product States and Projected Entangled Pair States; Rom\'an Or\'us
	\item The density-matrix renormalization group in the age of matrix product states; Ulrich Schollw\"ock
	\end{itemize}
\end{frame}

\end{document}

