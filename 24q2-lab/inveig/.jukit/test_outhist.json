{"FCwfdn1gJk": [{"name": "stderr", "output_type": "stream", "text": ["c:\\Users\\Hanse Kim\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\tqdm\\auto.py:21: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html\n", "  from .autonotebook import tqdm as notebook_tqdm\n"]}], "1lfI2QTNfq": [], "jtBYyAi6g9": [], "5FybpCh0Lz": [{"ename": "RuntimeError", "evalue": "shape '[50, 1, 600, 600]' is invalid for input of size 360000", "output_type": "error", "traceback": ["\u001b[1;31m---------------------------------------------------------------------------\u001b[0m", "\u001b[1;31mRuntimeError\u001b[0m                              Traceback (most recent call last)", "Cell \u001b[1;32mIn[8], line 5\u001b[0m\n\u001b[0;32m      3\u001b[0m \u001b[38;5;28meval\u001b[39m\u001b[38;5;241m.\u001b[39mset_rdsc(midx[\u001b[38;5;241m0\u001b[39m], midx[\u001b[38;5;241m1\u001b[39m])\n\u001b[0;32m      4\u001b[0m ptl_tr \u001b[38;5;241m=\u001b[39m \u001b[38;5;28meval\u001b[39m\u001b[38;5;241m.\u001b[39mfixed_tr(midx[\u001b[38;5;241m2\u001b[39m], \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mcoulomb\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m----> 5\u001b[0m evl_tr \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43meval\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mdsc_eigs\u001b[49m\u001b[43m(\u001b[49m\u001b[43mptl_tr\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m      6\u001b[0m factor \u001b[38;5;241m=\u001b[39m torch\u001b[38;5;241m.\u001b[39mmean(\u001b[38;5;241m1\u001b[39m\u001b[38;5;241m/\u001b[39m(evl_tr\u001b[38;5;241m/\u001b[39mevl_tr[:,:,\u001b[38;5;241m0\u001b[39m]\u001b[38;5;241m.\u001b[39mview(evl_tr\u001b[38;5;241m.\u001b[39mshape[\u001b[38;5;241m0\u001b[39m],evl_tr\u001b[38;5;241m.\u001b[39mshape[\u001b[38;5;241m1\u001b[39m],\u001b[38;5;241m1\u001b[39m)\u001b[38;5;241m.\u001b[39mexpand(\u001b[38;5;241m-\u001b[39m\u001b[38;5;241m1\u001b[39m, evl_tr\u001b[38;5;241m.\u001b[39mshape[\u001b[38;5;241m1\u001b[39m], evl_tr\u001b[38;5;241m.\u001b[39mshape[\u001b[38;5;241m2\u001b[39m])), dim \u001b[38;5;241m=\u001b[39m \u001b[38;5;241m0\u001b[39m)\n\u001b[0;32m      7\u001b[0m \u001b[38;5;28mprint\u001b[39m(midx, nn\u001b[38;5;241m.\u001b[39mL1Loss()(factor[\u001b[38;5;241m0\u001b[39m,:\u001b[38;5;241m5\u001b[39m],torch\u001b[38;5;241m.\u001b[39marange(\u001b[38;5;241m1\u001b[39m,\u001b[38;5;241m6\u001b[39m)\u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39m\u001b[38;5;241m2\u001b[39m), evl_tr[\u001b[38;5;241m0\u001b[39m,\u001b[38;5;241m0\u001b[39m,\u001b[38;5;241m0\u001b[39m])\n", "Cell \u001b[1;32mIn[5], line 49\u001b[0m, in \u001b[0;36mEvalEig.dsc_eigs\u001b[1;34m(self, ptl)\u001b[0m\n\u001b[0;32m     47\u001b[0m dsc_lap \u001b[38;5;241m=\u001b[39m (\u001b[38;5;241m-\u001b[39m\u001b[38;5;241m2\u001b[39m\u001b[38;5;241m*\u001b[39mtorch\u001b[38;5;241m.\u001b[39meye(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mrn) \u001b[38;5;241m+\u001b[39m torch\u001b[38;5;241m.\u001b[39mdiag(torch\u001b[38;5;241m.\u001b[39mones(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mrn\u001b[38;5;241m-\u001b[39m\u001b[38;5;241m1\u001b[39m),\u001b[38;5;241m1\u001b[39m) \u001b[38;5;241m+\u001b[39m torch\u001b[38;5;241m.\u001b[39mdiag(torch\u001b[38;5;241m.\u001b[39mones(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mrn\u001b[38;5;241m-\u001b[39m\u001b[38;5;241m1\u001b[39m),\u001b[38;5;241m-\u001b[39m\u001b[38;5;241m1\u001b[39m))\u001b[38;5;241m/\u001b[39m(\u001b[38;5;241m2\u001b[39m\u001b[38;5;241m*\u001b[39m(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mrm\u001b[38;5;241m/\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mrn)\u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39m\u001b[38;5;241m2\u001b[39m)\n\u001b[0;32m     48\u001b[0m dsc_lap \u001b[38;5;241m=\u001b[39m dsc_lap\u001b[38;5;241m.\u001b[39mview(\u001b[38;5;241m1\u001b[39m, \u001b[38;5;241m1\u001b[39m, \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mrn, \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mrn)\n\u001b[1;32m---> 49\u001b[0m dsc_ptl \u001b[38;5;241m=\u001b[39m \u001b[43mtorch\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mdiag_embed\u001b[49m\u001b[43m(\u001b[49m\u001b[43mptl\u001b[49m\u001b[43m)\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mview\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mbatch_dim\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m1\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mrn\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mrn\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m     51\u001b[0m \u001b[38;5;66;03m#dsc_lap = (-2*torch.eye(2*self.rn+1) + torch.diag(torch.ones(2*self.rn),1) + torch.diag(torch.ones(2*self.rn),-1))#/(2*(self.rm/self.rn)**2)\u001b[39;00m\n\u001b[0;32m     52\u001b[0m \u001b[38;5;66;03m#dsc_lap = dsc_lap.view(1, 1, 2*self.rn+1, 2*self.rn+1)\u001b[39;00m\n\u001b[0;32m     53\u001b[0m \u001b[38;5;66;03m#ptl_sym = torch.cat((torch.flip(ptl, dims = (1,)), torch.tensor([[1e-3]]), ptl), dim = 1)\u001b[39;00m\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m     56\u001b[0m \n\u001b[0;32m     57\u001b[0m \u001b[38;5;66;03m#dsc_eff = self.l_dsc*(self.l_dsc+1)*torch.diag(1/r_dsc_sym**2).view(1, 1, 2*self.rn+1, 2*self.rn+1)\u001b[39;00m\n\u001b[0;32m     58\u001b[0m dsc_eff \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39ml_dsc\u001b[38;5;241m*\u001b[39m(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39ml_dsc\u001b[38;5;241m+\u001b[39m\u001b[38;5;241m1\u001b[39m)\u001b[38;5;241m*\u001b[39mtorch\u001b[38;5;241m.\u001b[39mdiag(\u001b[38;5;241m1\u001b[39m\u001b[38;5;241m/\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mr_dsc\u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39m\u001b[38;5;241m2\u001b[39m)\u001b[38;5;241m.\u001b[39mview(\u001b[38;5;241m1\u001b[39m, \u001b[38;5;241m1\u001b[39m, \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mrn, \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mrn)\n", "\u001b[1;31mRuntimeError\u001b[0m: shape '[50, 1, 600, 600]' is invalid for input of size 360000"]}]}